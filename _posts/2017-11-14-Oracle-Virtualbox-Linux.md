Linux


# Start with virtual box

To play with linux virtual machine, you can choose to use VMplayer or VirtualBox.
VirtualBox from Oracle has a better licence.

You can change VirtualBox [language](http://ccm.net/faq/40865-virtualbox-how-to-change-the-language-settings)


You can download your Linux image and verify the download [checksum](https://www.lifewire.com/validate-md5-checksum-file-4037391), make sure that your download is perfect.
```
certutil -hashfile bodhi-4.1.0-64.iso MD5 
```
output should be the same as your MD5 file, if the values don't match then the file is not valid and you should download it again.


To share your host harddisk with guest linux [virtual machine](https://www.youtube.com/watch?v=h8cA3pIAeZQ).
https://www.htpcbeginner.com/mount-virtualbox-shared-folder-on-ubuntu-linux/


# Linux file read
[cat vs grep vs awk vs sed comparison](https://askubuntu.com/questions/564944/cat-vs-grep-vs-awk-command-get-the-file-content-which-one-is-more-efficient-and)
```
# show your centOS version
$ cat /etc/centos-release
$ awk 1  /etc/centos-release

$ time for i in {1..1000}; do cat temp.txt; done
$ time for i in {1..1000}; do grep "$" temp.txt; done
$ time for i in {1..1000}; do awk "/$/" temp.txt; done
```

# CoreOS linux inside VirtualBox
CoreOS is widely used for Docker, kubernetes and cloud based VMs. So it's time to see how to create CoreOS linux with VirtualBox.  
If your host OS is linux as well, then you can follow official guide https://coreos.com/os/docs/latest/booting-on-virtualbox.html

In my case host OS is win10, so I follow https://deis.com/blog/2015/coreos-on-virtualbox/ and do all steps manually.  
Several important things to know:   
memery should provide at least 2G, otherwise you will have kernel panic, out of memory errors when start up iso.  
![storage settings must be carefull:]({{ site.url }}/images/VirtualBoxStorage.png)

once CoreOS start, by default it login as user core without password. Then you start to cloud_config.yml to create users, ssh keys...
https://coreos.com/os/docs/latest/cloud-config.html    
This file is saved /home/core by run `cat > cloud_config.yml <contents...>`, ctl+z quit the edit. Inside the contents, you can't not move left,right,up and down, so type carefully. You could try install nano etc follow https://unix.stackexchange.com/questions/203606/is-there-any-way-to-install-nano-on-coreos but not tested
1. Boot up the CoreOS box and connect as the core user   
2. Run the /bin/toolbox command to enter the stock Fedora container.    
3. Install any software you need. To install nano in this case, it would be as simple as doing a dnf -y install nano (dnf has replaced yum)    
4. Use nano to edit files. "But wait -- I'm in a container!" Don't worry -- the host's file system is mounted at /media/root when inside the container. So just save a sample text file at /media/root/home/core/test.txt, then exit the container, and finally go list the files in /home/core. Notice your test.txt file?    

```
#!
#cloud-config
users:
- name: nitish
  # passwd are hashed and generated by    sudo openssl passwd -1
  passwd: $1$yxV9YDKT$s.fAj5dlFyrPwrH0xAQJy/
  groups:
  - sudo
  - docker
ssh_authorized_keys:
  - ssh_rsa AAAAB3NzaC1...snip
```

Reboot and install CoreOS into the harddisk /dev/sda  https://coreos.com/os/docs/latest/installing-to-disk.html    
```
sudo coreos-install -d /dev/sda -C stable -c ~/cloud-config.yaml
```
Then you can unmount ISO and continu further test.   

Connecting the CoreOS with ssh, you need config ![port forwarding]({{ site.url }}/images/VirtualBoxPortForward.png)
open a cmd in your Host win10
```
>> ssh -p 22022 core@127.0.0.1
Last login: Thu Apr 23 15:50:31 2015 from 192.168.59.3
CoreOS stable (633.1.0)
core@localhost ~ $
```




